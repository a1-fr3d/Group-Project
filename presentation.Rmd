---
title: "Student Spending"
subtitle: 
author: " Brainless Data Group <br> Alfred, Leo, Rolan"
institute: "University of Edinburgh"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r load-packages, include = FALSE}
# Add any additional packages you need to this chunk
library(tidyverse)
library(palmerpenguins)
library(knitr)
library(xaringanthemer)
```

```{r setup, include=FALSE}
# For better figure resolution
knitr::opts_chunk$set(fig.retina = 3, dpi = 300, fig.width = 6, fig.asp = 0.618, out.width = "80%")
```

```{r load-data, include=FALSE}
# Load your data here
monthly_expense <- read.csv("monthly_expense.csv")
```

```{r include=FALSE}
style_xaringan(
  title_slide_background_image = "wallpaper.jpg",
  title_slide_text_color = "black"
)
```

class: center, middle

## What Affects Student Spending?

---

class: inverse, center, middle

# Kaggle

---

class: inverse, center, middle

# Variables - 13

---

class: inverse, center, middle

## Observations - 105

---

# Variables that we will use...

.pull-left[
# Monthly Expense
]
.pull-right[
- Gender
- Year of Study
- Living
- Scholarship
- Part-time
- Transport
- Smoking
- Drinking
- Games and Hobbies
- Self-care
- Monthly Subscription
]

---

# Table

```{r table, echo = FALSE}
glimpse(monthly_expense)

```

---
class: center, middle
# Hypothesis

 As year of study increases, spending also increases.

---

# Gender

```{r, Gender, echo = FALSE}
me <- monthly_expense %>%
  filter(!is.na(Monthly_expenses))

ggplot(data = me, mapping = aes(x = Monthly_expenses, y = Gender, color = Gender)) +
  geom_boxplot() +
  labs(x = "Mothly Expenses",
       y = "Gender", 
       title = "The Relationship Between Gender and Monthly Expense")
```

---

# Age

```{r, Age, echo=FALSE}
me <- monthly_expense %>%
  filter(Monthly_expenses < 600) %>%
  mutate(Age = as.character(Age))
ggplot(data = me, mapping = aes(y = Monthly_expenses, 
                                x = Age,
                                color = Age)) + 
  geom_boxplot() +
  labs(title = "The Effect of Age on Monthly Expenses",
       y = "Monthly Expeneses")
```

---

# Year of Study

``` {r, Study Year, echo = FALSE}
me <- monthly_expense %>%
  filter(Monthly_expenses < 600,
         Study_year <= 4) %>%
  mutate(Study_year = as.character(Study_year))
ggplot(data = me, mapping = aes(y = Monthly_expenses,
                                x = Study_year,
                                fill = Study_year)) +
  geom_violin()
```

---

#Living
```{r, Living, echo = FALSE}
me1 <- read.csv("monthly_expense.csv", na="") %>%
  mutate(Living = as.factor(Living))

me2 <- filter(me1, !is.na(Living) & !is.na(Monthly_expenses)) 
  ggplot(data = me2, mapping = aes(x = Monthly_expenses, fill = Living)) +
          geom_histogram(binwidth = 10) +
          facet_wrap(~Living)
  ggplot(data = me2, mapping = aes(x = Living,y = Monthly_expenses, fill = Living)) +
geom_violin()



```

---

#Scholarship

```{r, Scholarship, echo = FALSE}
filter(me2, !is.na(Scholarship)) %>%
  ggplot(mapping = aes(x = Scholarship, y = Monthly_expenses), fill = Scholarship) +
  geom_violin()
```