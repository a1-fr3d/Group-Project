---
title: "Student Spending"
subtitle: 
author: " Brainless Data Group <br> Alfred, Leo, Rolan"
institute: "University of Edinburgh"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r load-packages, include = FALSE}
# Add any additional packages you need to this chunk
library(tidyverse)
library(palmerpenguins)
library(knitr)
library(xaringanthemer)
library(tidymodels)
```

```{r setup, include=FALSE}
# For better figure resolution
knitr::opts_chunk$set(fig.retina = 3, dpi = 300, fig.width = 6, fig.asp = 0.618, out.width = "80%")
```

```{r load-data, include=FALSE}
# Replace all empty space in the survey responds with NA
monthly_expense <- read.csv("monthly_expense.csv", na = "")
```

```{r include=FALSE}
style_xaringan(
  title_slide_background_image = "wallpaper.jpg",
  title_slide_text_color = "black"
)
```

class: center, middle

## What Affects Student Spending?

---

class: inverse, center, middle

# Kaggle

---

class: inverse, center, middle

# Variables - 13

---

class: inverse, center, middle

## Observations - 105

---

# Variables that we will use...

.pull-left[
# Monthly Expense
]
.pull-right[
- Gender
- Year of Study
- Living
- Scholarship
- Part-time
- Transport
- Smoking
- Drinking
- Games and Hobbies
- Self-care
- Monthly Subscription
]

---

# Table

```{r table, echo = FALSE}
glimpse(monthly_expense)

```

---
class: center, middle
# Hypothesis

 As year of study increases, spending also increases.

---

# Gender

```{r, Gender, echo = FALSE}
me <- monthly_expense %>%
  filter(!is.na(Monthly_expenses))

ggplot(data = me, mapping = aes(x = Monthly_expenses, y = Gender, fill = Gender)) +
  geom_boxplot() +
  labs(x = "Mothly Expenses",
       y = "Gender", 
       title = "The Relationship Between Gender and Monthly Expense")
```

---

# Age

```{r, Age, echo=FALSE}
me <- monthly_expense %>%
  filter(Monthly_expenses < 600) %>%
  mutate(Age = as.character(Age))
ggplot(data = me, mapping = aes(y = Monthly_expenses, 
                                x = Age,
                                fill = Age)) + 
  geom_boxplot() +
  labs(title = "The Effect of Age on Monthly Expenses",
       y = "Monthly Expeneses")
```

---

# Year of Study

``` {r, Study Year, echo = FALSE}
me <- monthly_expense %>%
  filter(Monthly_expenses < 600,
         Study_year <= 4) %>%
  mutate(Study_year = as.character(Study_year))
ggplot(data = me, mapping = aes(y = Monthly_expenses,
                                x = Study_year,
                                fill = Study_year)) +
  geom_violin()
```

---

#Living

```{r, Living, echo = FALSE}
me <- monthly_expense %>%
  mutate(Living = as.factor(Living)) %>%
  filter(!is.na(Living) & !is.na(Monthly_expenses))
  ggplot(data = me, mapping = aes(x = Living,y = Monthly_expenses, fill = Living)) +
geom_boxplot()

```

---

#Scholarship

```{r, Scholarship, echo = FALSE}
me <- monthly_expense %>%
  filter(!is.na(Scholarship) & !is.na(Monthly_expenses))

ggplot(data = me, mapping = aes(x = Scholarship, 
                     y = Monthly_expenses, 
                     fill = Scholarship)) +
  geom_boxplot()
```

---

```{r, summarise, echo = FALSE}
# Create function that will plot counts against different responds on one variable
x <- function(i){
ggplot(data = me[i], aes(x = names(me[i]))) +
  geom_bar() +
  facet_wrap(names(me[i]))
  
}
x(1)
x(2)
x(3)
x(4)
x(5)
x(6)
x(7)
x(8)
x(9)
x(10)
x(11)
x(12)
```

---

```{r regression, echo = FALSE}
# Impact of variables on monthly expense at a first glance. This regression model does not consider the relation between predictors.
reg <- linear_reg() %>%
  set_engine("lm") %>%
  fit(Monthly_expenses ~ ., data = me) %>%
  tidy()
```

---

```{r reg_example, echo = FALSE}
reg1 <- linear_reg() %>%
  set_engine("lm") %>%
  fit(Monthly_expenses ~ Study_year*Living, data = me) %>%
  tidy()

```